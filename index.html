<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Haru Yoga | ヨガスタジオ</title>

<!-- Google Fonts（正しいlink） -->
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;600;700&display=swap" rel="stylesheet">
<!-- Font Awesome（正しいlink） -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
:root{
  --bg:#0f172a; --panel:#111827; --soft:#1f2937; --soft2:#0b1020;
  --text:#e5e7eb; --muted:#9ca3af;
  --brand:#22c55e; /* 柔らかなグリーン */
  --accent:#ef8354; --ring:rgba(34,197,94,.22);
  --radius:14px; --shadow:0 10px 30px rgba(0,0,0,.25);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family:'Noto Sans JP',system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
  background:linear-gradient(180deg,#0f172a 0%, #111827 70%, #1f2937 100%);
  color:var(--text); line-height:1.8;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
a{color:inherit; text-decoration:none}
img{max-width:100%; display:block}

/* Header / Nav */
header{
  position:sticky; top:0; z-index:40; backdrop-filter:blur(8px);
  background:rgba(17,24,39,.75); border-bottom:1px solid rgba(255,255,255,.06);
}
.nav{max-width:1200px; margin:auto; padding:14px 20px; display:flex; align-items:center; gap:14px}
.brand{display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.4px}
.brand i{color:var(--brand)}
.nav ul{list-style:none; display:flex; gap:22px; margin:0; padding:0}
.nav a{opacity:.9; font-size:14px}
.nav a:hover{opacity:1}

/* Hero */
.hero{
  position:relative; min-height:88vh; display:grid; place-items:center; padding:28px 20px;
  background:
    linear-gradient(to bottom right, rgba(34,197,94,.2), rgba(17,24,39,.6)),
    url('https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?q=80&w=2000&auto=format&fit=crop') center/cover no-repeat;
}
.hero-box{
  max-width:900px; width:100%; padding:48px 28px; text-align:center;
  background:rgba(17,24,39,.55); border:1px solid rgba(255,255,255,.08);
  border-radius:var(--radius); box-shadow:var(--shadow)
}
.hero h1{font-size:34px; margin:0 0 10px}
.hero p{color:#d1d5db; margin-bottom:22px}
.btn{
  display:inline-flex; align-items:center; justify-content:center; gap:8px;
  padding:12px 20px; border-radius:10px; border:1px solid transparent; cursor:pointer; transition:.2s;
  font-weight:600; font-size:14px;
}
.btn.primary{background:var(--brand); color:#052e16}
.btn.primary:hover{filter:brightness(1.05); transform:translateY(-2px)}
.btn.ghost{border:1px solid rgba(255,255,255,.2); background:rgba(255,255,255,.06); color:#fff}
.btn.ghost:hover{border-color:var(--accent); box-shadow:0 0 0 6px rgba(239,131,84,.18)}

/* Section */
.container{max-width:1200px; margin:0 auto; padding:60px 20px}
.section-title{font-size:24px; font-weight:700; margin:0 0 10px; text-align:center}
.section-lead{color:var(--muted); text-align:center; margin:0 auto 36px; max-width:760px}

/* Features */
.features{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:18px}
.feature{
  background:var(--soft); padding:22px; border-radius:14px; border:1px solid rgba(255,255,255,.06);
}
.feature i{color:#fde68a; font-size:22px; margin-bottom:8px}
.feature h4{margin:0 0 6px}

/* Class Filters/Search */
.toolbar{display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:18px}
.filter-chip{
  border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.05);
  color:#d1d5db; padding:8px 12px; border-radius:999px; cursor:pointer; font-size:13px;
}
.filter-chip.active{border-color:var(--brand); box-shadow:0 0 0 4px var(--ring)}
.toolbar .grow{flex:1}
.input{
  width:100%; border:1px solid rgba(255,255,255,.1); background:var(--soft2);
  color:#fff; padding:11px 12px; border-radius:10px; outline:none;
}
.input:focus{border-color:var(--brand); box-shadow:0 0 0 4px var(--ring)}
.select{
  border:1px solid rgba(255,255,255,.1); background:var(--soft2); color:#fff; padding:11px 12px; border-radius:10px;
}

/* Classes Grid */
.grid{display:grid; grid-template-columns:repeat(3,1fr); gap:18px}
@media (max-width:1024px){ .grid{grid-template-columns:repeat(2,1fr)} }
@media (max-width:640px){ .grid{grid-template-columns:1fr} }

.card{
  background:#0d1324; border:1px solid rgba(255,255,255,.08); border-radius:16px; overflow:hidden; display:flex; flex-direction:column;
}
.card .media{position:relative}
.card img{width:100%; height:170px; object-fit:cover}
.badge{
  position:absolute; left:12px; top:12px; background:rgba(34,197,94,.18);
  color:#dcfce7; border:1px solid rgba(34,197,94,.35); padding:4px 8px; font-size:12px; border-radius:999px;
}
.card .body{padding:16px}
.meta{display:flex; gap:8px; flex-wrap:wrap; color:#a7b0bb; font-size:12px}
.actions{display:flex; gap:8px; padding:16px; margin-top:auto}
.star{color:#fde68a}

/* Schedule */
.schedule{display:grid; gap:12px; max-width:900px; margin:0 auto}
.slot{
  display:grid; grid-template-columns:120px 1fr 120px; gap:14px;
  background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.07);
  border-radius:12px; padding:10px 12px; align-items:center;
}
@media (max-width:640px){ .slot{grid-template-columns:110px 1fr} .slot .coach{display:none} }
.slot strong{font-size:14px}

/* Instructors */
.instructors{display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:18px}
.coach-card{
  background:var(--soft); border:1px solid rgba(255,255,255,.06); border-radius:14px; overflow:hidden;
}
.coach-card img{width:100%; height:220px; object-fit:cover}
.coach-card .body{padding:14px}
.tagline{color:var(--muted); font-size:13px}

/* Pricing */
.pricing{display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:18px}
.plan{
  background:#f5efe6; color:#2b2d42; border-radius:16px; padding:22px; position:relative;
}
.plan.featured{outline:2px solid var(--brand); box-shadow:0 10px 30px rgba(34,197,94,.25)}
.price{font-size:26px; font-weight:700; margin:8px 0 12px}
.plan ul{padding-left:1rem; margin:0 0 10px}
.plan li{margin:6px 0}
.plan .buy{
  background:var(--brand); color:#052e16; border:none; padding:11px 14px; border-radius:10px; font-weight:700; cursor:pointer;
}
.plan .buy:hover{filter:brightness(1.05)}

/* Gallery */
.gallery{display:grid; grid-template-columns:2fr 1fr 1fr; gap:14px}
@media (max-width:780px){ .gallery{grid-template-columns:1fr 1fr} }
@media (max-width:520px){ .gallery{grid-template-columns:1fr} }
.gallery img{width:100%; height:100%; object-fit:cover; border-radius:12px}

/* Contact */
.contact{
  background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08);
  border-radius:16px; padding:22px; max-width:860px; margin:0 auto
}
.grid-2{display:grid; grid-template-columns:1fr 1fr; gap:14px}
@media (max-width:640px){ .grid-2{grid-template-columns:1fr} }
.field{display:grid; gap:6px}
label{font-size:12px; color:#c7d2fe}
input, textarea, select{
  background:var(--soft2); border:1px solid rgba(255,255,255,.08);
  color:#e5e7eb; border-radius:10px; padding:11px 12px; font-size:14px; outline:none
}
input:focus, textarea:focus, select:focus{border-color:var(--brand); box-shadow:0 0 0 4px var(--ring)}

/* Drawer (予約リスト) */
.drawer{
  position:fixed; top:0; right:-460px; width:440px; max-width:92vw; height:100%;
  background:#0b0f1d; border-left:1px solid rgba(255,255,255,.08); z-index:60; display:flex; flex-direction:column; transition:right .28s ease;
}
.drawer.open{right:0}
.drawer-header{
  display:flex; align-items:center; justify-content:space-between; padding:16px;
  border-bottom:1px solid rgba(255,255,255,.08);
}
.drawer-body{flex:1; overflow:auto; padding:14px}
.res-item{
  display:grid; grid-template-columns:64px 1fr auto; gap:10px; align-items:center;
  border-bottom:1px solid rgba(255,255,255,.06); padding:10px 0;
}
.res-item img{width:64px; height:64px; object-fit:cover; border-radius:8px}
.res-title{font-size:14px; font-weight:700}
.res-meta{color:var(--muted); font-size:12px}
.small{font-size:12px; color:var(--muted)}
.qty{display:flex; align-items:center; gap:8px}
.qty button{
  width:28px; height:28px; border-radius:8px; border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.06); color:#fff; cursor:pointer;
}
.remove{color:#fecaca; background:transparent; border:none; cursor:pointer}
.drawer-footer{border-top:1px solid rgba(255,255,255,.08); padding:16px; display:grid; gap:10px}
.total-row{display:flex; justify-content:space-between; align-items:center}
.checkout{
  background:var(--brand); color:#052e16; border:none; padding:12px; border-radius:10px; font-weight:700; cursor:pointer;
}
.empty{color:var(--muted); text-align:center; padding:24px 0}

/* Footer */
footer{
  background:#0b0f1d; color:#cbd5e1; padding:48px 20px; border-top:1px solid rgba(255,255,255,.06)
}
.foot{
  max-width:1200px; margin:0 auto; display:grid; gap:18px; grid-template-columns:2fr 1fr 1fr 1fr;
}
@media (max-width:780px){ .foot{grid-template-columns:1fr 1fr} }
footer h5{margin:0 0 10px; color:#fff; font-size:13px}
.copy{text-align:center; color:#94a3b8; font-size:12px; margin-top:20px}
</style>
</head>
<body>

<!-- Header -->
<header>
  <nav class="nav" aria-label="メインナビ">
    <div class="brand"><i class="fa-solid fa-seedling"></i> Haru Yoga</div>
    <ul>
      <li><a href="#about">特徴</a></li>
      <li><a href="#classes">クラス</a></li>
      <li><a href="#schedule">スケジュール</a></li>
      <li><a href="#pricing">料金</a></li>
      <li><a href="#contact">お問い合わせ</a></li>
    </ul>
    <button id="openDrawer" class="btn ghost" aria-label="予約リストを開く"><i class="fa-solid fa-calendar-check"></i> 予約リスト</button>
  </nav>
</header>

<!-- Hero -->
<section class="hero">
  <div class="hero-box">
    <h1>呼吸と動きで、やさしく整う。</h1>
    <p>Haru Yoga は、はじめての方から上級者まで、心身のバランスを育む少人数制スタジオ。フロー、リストア、瞑想まで、あなたに合ったクラスが見つかります。</p>
    <div>
      <a class="btn primary" href="#classes"><i class="fa-solid fa-spa"></i> クラスを探す</a>
      <a class="btn ghost" href="#contact"><i class="fa-regular fa-envelope"></i> 無料体験を予約</a>
    </div>
  </div>
</section>

<!-- About / Features -->
<section id="about" class="container">
  <h2 class="section-title">Haru Yoga のこだわり</h2>
  <p class="section-lead">姿勢・呼吸・可動性にフォーカスしたクラス設計。ゆるやかな成長を、毎日の生活に。</p>
  <div class="features">
    <div class="feature">
      <i class="fa-solid fa-heart-pulse" aria-hidden="true"></i>
      <h4>身体の土台を整える</h4>
      <p>呼吸とアライメントを意識し、無理のない動きで基礎からサポート。</p>
    </div>
    <div class="feature">
      <i class="fa-solid fa-people-group" aria-hidden="true"></i>
      <h4>少人数・丁寧なガイド</h4>
      <p>一人ひとりに目が届く規模で、安心して続けられます。</p>
    </div>
    <div class="feature">
      <i class="fa-solid fa-moon" aria-hidden="true"></i>
      <h4>回復と休息を大切に</h4>
      <p>リストアや瞑想で自律神経を整え、睡眠や集中にも好影響。</p>
    </div>
    <div class="feature">
      <i class="fa-solid fa-clock" aria-hidden="true"></i>
      <h4>通いやすい時間帯</h4>
      <p>朝・昼・夜・週末のクラスで、暮らしに馴染むペースづくり。</p>
    </div>
  </div>
</section>

<!-- Classes (Search / Filter / Sort) -->
<section id="classes" class="container">
  <h2 class="section-title">クラスを選ぶ</h2>
  <p class="section-lead">検索・カテゴリ・並び替えで、目的や気分に合うクラスを見つけましょう。</p>

  <div class="toolbar" role="toolbar" aria-label="クラスのフィルター">
    <button class="filter-chip active" data-filter="all">すべて</button>
    <button class="filter-chip" data-filter="beginner">はじめて</button>
    <button class="filter-chip" data-filter="flow">フロー</button>
    <button class="filter-chip" data-filter="restore">リストア</button>
    <button class="filter-chip" data-filter="meditation">瞑想</button>

    <div class="grow"></div>
    <input id="q" class="input" type="search" placeholder="キーワード検索（例：背中、睡眠、呼吸）" aria-label="検索">
    <select id="sortSelect" class="select" aria-label="並び替え">
      <option value="featured">おすすめ順</option>
      <option value="time">開始時刻の早い順</option>
      <option value="level">やさしい順（難易度）</option>
      <option value="rating">人気（評価）順</option>
    </select>
  </div>

  <div id="grid" class="grid" aria-label="クラス一覧"><!-- JSで描画 --></div>
</section>

<!-- Schedule -->
<section id="schedule" class="container">
  <h2 class="section-title">今週のスケジュール</h2>
  <p class="section-lead">はじめての方は、★マークの入門クラスがおすすめです。</p>
  <div class="schedule" aria-label="週間スケジュール">
    <div class="slot">
      <span>月 07:30</span>
      <div><strong>モーニング・フロー</strong><br><span class="small">呼吸に合わせた全身の流れで一日を軽やかに</span></div>
      <span class="coach">担当：ミホ</span>
    </div>
    <div class="slot">
      <span>火 19:15</span>
      <div><strong>やさしい入門★</strong><br><span class="small">基本のポーズと呼吸。はじめての方に最適</span></div>
      <span class="coach">担当：アキ</span>
    </div>
    <div class="slot">
      <span>水 12:10</span>
      <div><strong>骨盤リセット</strong><br><span class="small">骨盤周りの安定と可動域アップ</span></div>
      <span class="coach">担当：ユナ</span>
    </div>
    <div class="slot">
      <span>木 20:00</span>
      <div><strong>リストア＆ブリーズ</strong><br><span class="small">緊張をほどく深いリラックスと睡眠改善</span></div>
      <span class="coach">担当：ソラ</span>
    </div>
    <div class="slot">
      <span>土 10:00</span>
      <div><strong>ヴィンヤサ・フロー</strong><br><span class="small">強度を調整しながら流れに身を任せる</span></div>
      <span class="coach">担当：ナオ</span>
    </div>
  </div>
</section>

<!-- Instructors -->
<section class="container">
  <h2 class="section-title">インストラクター</h2>
  <p class="section-lead">経験豊富な講師が、それぞれのアプローチで「今のあなた」に寄り添います。</p>
  <div class="instructors">
    <div class="coach-card">
      <img src="https://images.unsplash.com/photo-1526506118085-60ce8714f8c5?q=80&w=1600&auto=format&fit=crop" alt="インストラクター ミホ">
      <div class="body">
        <strong>ミホ</strong>
        <div class="tagline">呼吸×アライメント｜モーニング担当</div>
      </div>
    </div>
    <div class="coach-card">
      <img src="https://images.unsplash.com/photo-1549060279-ab1c0882609f?q=80&w=1600&auto=format&fit=crop" alt="インストラクター アキ">
      <div class="body">
        <strong>アキ</strong>
        <div class="tagline">入門・背骨ケア｜夜クラス担当</div>
      </div>
    </div>
    <div class="coach-card">
      <img src="https://images.unsplash.com/photo-1521575107034-e0fa0b594529?q=80&w=1600&auto=format&fit=crop" alt="インストラクター ユナ">
      <div class="body">
        <strong>ユナ</strong>
        <div class="tagline">骨盤・骨格調整｜ランチクラス担当</div>
      </div>
    </div>
    <div class="coach-card">
      <img src="https://images.unsplash.com/photo-1540206276207-3af25c08abc4?q=80&w=1600&auto=format&fit=crop" alt="インストラクター ソラ">
      <div class="body">
        <strong>ソラ</strong>
        <div class="tagline">リストア・瞑想｜夜クラス担当</div>
      </div>
    </div>
  </div>
</section>

<!-- Pricing -->
<section id="pricing" class="container">
  <h2 class="section-title">料金プラン</h2>
  <p class="section-lead">続けやすく、通いやすい。プランはいつでも変更できます。</p>
  <div class="pricing">
    <div class="plan">
      <h4>ドロップイン</h4>
      <div class="price">¥2,500 / 回</div>
      <ul>
        <li>お好きなクラスに都度参加</li>
        <li>契約不要・初回体験にも</li>
        <li>マット貸出込み</li>
      </ul>
      <button class="buy" onclick="document.getElementById('contact').scrollIntoView({behavior:'smooth'})">体験を申し込む</button>
    </div>
    <div class="plan featured">
      <h4>スタンダード（人気）</h4>
      <div class="price">¥9,800 / 月</div>
      <ul>
        <li>月8回まで参加</li>
        <li>優先予約＆キャンセル待ち</li>
        <li>姿勢チェック（毎月）</li>
      </ul>
      <button class="buy" onclick="document.getElementById('contact').scrollIntoView({behavior:'smooth'})">無料体験から始める</button>
    </div>
    <div class="plan">
      <h4>アンリミテッド</h4>
      <div class="price">¥16,800 / 月</div>
      <ul>
        <li>回数無制限</li>
        <li>同伴1名まで無料（月1回）</li>
        <li>ワークショップ 15%OFF</li>
      </ul>
      <button class="buy" onclick="document.getElementById('contact').scrollIntoView({behavior:'smooth'})">今すぐ入会</button>
    </div>
  </div>
</section>

<!-- Gallery -->
<section class="container">
  <h2 class="section-title">スタジオの雰囲気</h2>
  <div class="gallery">
    <img src="https://images.unsplash.com/photo-1552196563-55cd4e45efb3?q=80&w=1600&auto=format&fit=crop" alt="スタジオ風景1">
    <img src="https://images.unsplash.com/photo-1545205597-3d9d02c29597?q=80&w=1600&auto=format&fit=crop" alt="スタジオ風景2">
    <img src="https://images.unsplash.com/photo-1518611012118-696072aa579a?q=80&w=1600&auto=format&fit=crop" alt="スタジオ風景3">
  </div>
</section>

<!-- Contact -->
<section id="contact" class="container">
  <h2 class="section-title">無料体験・お問い合わせ</h2>
  <p class="section-lead">体験予約やご質問はこちらから。24時間以内にご返信します。</p>
  <form class="contact" onsubmit="event.preventDefault(); alert('ありがとうございます！担当者よりメールでご連絡します。');" aria-label="お問い合わせフォーム">
    <div class="grid-2">
      <div class="field">
        <label for="name">お名前</label>
        <input id="name" name="name" placeholder="山田 太郎" required>
      </div>
      <div class="field">
        <label for="email">メールアドレス</label>
        <input id="email" name="email" type="email" placeholder="you@example.com" required>
      </div>
    </div>
    <div class="grid-2">
      <div class="field">
        <label for="prefclass">希望クラス</label>
        <select id="prefclass" name="prefclass">
          <option>やさしい入門</option>
          <option>モーニング・フロー</option>
          <option>ヴィンヤサ・フロー</option>
          <option>リストア＆ブリーズ</option>
          <option>瞑想ベーシック</option>
        </select>
      </div>
      <div class="field">
        <label for="time">希望時間帯</label>
        <select id="time" name="time">
          <option>朝</option>
          <option>昼</option>
          <option>夜</option>
          <option>週末</option>
        </select>
      </div>
    </div>
    <div class="field">
      <label for="notes">ご要望・既往歴など</label>
      <textarea id="notes" name="notes" rows="4" placeholder="配慮が必要な点や目標などがあればご記入ください。"></textarea>
    </div>
    <button class="btn primary" type="submit"><i class="fa-solid fa-paper-plane"></i> 送信する</button>
  </form>
</section>

<!-- Footer -->
<footer>
  <div class="foot">
    <div>
      <h5>Haru Yoga</h5>
      <p>呼吸に寄り添い、毎日に心地よい余白を。はじめての方も安心のヨガスタジオです。</p>
    </div>
    <div>
      <h5>メニュー</h5>
      <p><a href="#about">特徴</a>／<a href="#classes">クラス</a>／<a href="#pricing">料金</a></p>
    </div>
    <div>
      <h5>サポート</h5>
      <p>よくある質問／スタジオポリシー／アクセス</p>
    </div>
    <div>
      <h5>所在地</h5>
      <p>（例）リヤド・アルラビー<br>hello@haru-yoga.jp</p>
    </div>
  </div>
  <div class="copy">© 2026 Haru Yoga. All rights reserved.</div>
</footer>

<!-- Drawer: 予約リスト -->
<aside id="drawer" class="drawer" aria-label="予約リスト" aria-hidden="true">
  <div class="drawer-header">
    <h3 style="margin:0">予約リスト</h3>
    <button id="closeDrawer" class="btn ghost"><i class="fa-solid fa-xmark"></i> 閉じる</button>
  </div>
  <div id="resList" class="drawer-body"><!-- JSで描画 --></div>
  <div class="drawer-footer">
    <div class="total-row"><strong>合計セッション</strong><div id="totalSessions">0</div></div>
    <button id="checkoutBtn" class="checkout">リクエスト送信</button>
    <small class="small">※送信はデモ動作です。実装時は予約システムやメール連携をご利用ください。</small>
  </div>
</aside>

<script>
/* ========= クラスデータ ========= */
const CLASSES = [
  {
    id:'c1', title:'やさしい入門', category:'beginner', level:1, rating:4.9,
    coach:'アキ', duration:60,
    times:['火 19:15','金 18:30','日 09:00'],
    img:'https://images.unsplash.com/photo-1552196563-55cd4e45efb3?q=80&w=1600&auto=format&fit=crop',
    desc:'基本のポーズと呼吸。初めての方やお久しぶりの方に。'
  },
  {
    id:'c2', title:'モーニング・フロー', category:'flow', level:2, rating:4.7,
    coach:'ミホ', duration:60,
    times:['月 07:30','水 07:30','土 08:00'],
    img:'https://images.unsplash.com/photo-1545205597-3d9d02c29597?q=80&w=1600&auto=format&fit=crop',
    desc:'呼吸に合わせて全身をつなぐ、朝に最適な流れ。'
  },
  {
    id:'c3', title:'ヴィンヤサ・フロー', category:'flow', level:3, rating:4.6,
    coach:'ナオ', duration:70,
    times:['土 10:00','木 18:30'],
    img:'https://images.unsplash.com/photo-1518310383802-640c2de311b2?q=80&w=1600&auto=format&fit=crop',
    desc:'強度を調整しながらダイナミックに動くフロースタイル。'
  },
  {
    id:'c4', title:'リストア＆ブリーズ', category:'restore', level:1, rating:4.8,
    coach:'ソラ', duration:65,
    times:['木 20:00','日 18:00'],
    img:'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?q=80&w=1600&auto=format&fit=crop',
    desc:'副交感神経を促し、深く緩む回復セッション。'
  },
  {
    id:'c5', title:'瞑想ベーシック', category:'meditation', level:1, rating:4.5,
    coach:'ソラ', duration:40,
    times:['火 20:30','金 20:30'],
    img:'https://images.unsplash.com/photo-1543975200-8e313fb04c4a?q=80&w=1600&auto=format&fit=crop',
    desc:'はじめての瞑想。姿勢と呼吸から静けさを育てる。'
  },
  {
    id:'c6', title:'骨盤リセット', category:'restore', level:2, rating:4.6,
    coach:'ユナ', duration:55,
    times:['水 12:10','日 11:00'],
    img:'https://images.unsplash.com/photo-1599050751795-5f2e68da9d1f?q=80&w=1600&auto=format&fit=crop',
    desc:'骨盤周りの安定と可動域アップにフォーカス。'
  }
];

/* ========= 状態 ========= */
let state = {
  q:'', filter:'all', sort:'featured',
  reservations: loadRes()
};
function loadRes(){
  try{ return JSON.parse(localStorage.getItem('haru_reservations')) || {}; }
  catch(e){ return {}; }
}
function saveRes(){
  localStorage.setItem('haru_reservations', JSON.stringify(state.reservations));
}

/* ========= ユーティリティ ========= */
const byTimeVal = (t)=>{
  const days = {'月':1,'火':2,'水':3,'木':4,'金':5,'土':6,'日':7};
  const [d, hm] = t.split(' ');
  const [h, m] = hm.split(':').map(Number);
  return days[d] * 10000 + h * 100 + m;
};
function sortFn(a,b){
  if(state.sort==='time'){
    return byTimeVal(a.times[0]) - byTimeVal(b.times[0]);
  }
  if(state.sort==='level'){
    return a.level - b.level;
  }
  if(state.sort==='rating'){
    return b.rating - a.rating;
  }
  const order = {beginner:0, restore:1, flow:2, meditation:3};
  if(order[a.category] !== order[b.category]) return order[a.category]-order[b.category];
  return b.rating - a.rating;
}
function matches(c){
  const okFilter = (state.filter==='all' || c.category===state.filter);
  const q = state.q.trim().toLowerCase();
  const okQ = !q || c.title.toLowerCase().includes(q) || c.desc.toLowerCase().includes(q) || c.coach.toLowerCase().includes(q);
  return okFilter && okQ;
}

/* ========= レンダリング：クラス ========= */
function renderClasses(){
  const grid = document.getElementById('grid');
  grid.innerHTML = '';
  const items = [...CLASSES].filter(matches).sort(sortFn);
  if(items.length===0){
    grid.innerHTML = `<div class="section-lead">該当するクラスが見つかりません。条件を変更してお試しください。</div>`;
    return;
  }
  for(const c of items){
    const card = document.createElement('article');
    card.className = 'card';
    card.innerHTML = `
      <div class="media">
        <img src="${c.img}" alt="${c.title}">
        <span class="badge">${c.category==='beginner'?'入門':'おすすめ'}</span>
      </div>
      <div class="body">
        <h3 style="margin:0 0 6px">${c.title}</h3>
        <div class="meta">
          <span><i class="fa-regular fa-user"></i> ${c.coach}</span>
          <span><i class="fa-regular fa-clock"></i> ${c.duration}分</span>
          <span title="難易度"><i class="fa-solid fa-wave-square"></i> Lv.${c.level}</span>
          <span class="star" title="評価"><i class="fa-solid fa-star"></i> ${c.rating.toFixed(1)}</span>
        </div>
        <p style="margin:8px 0 0; color:#a7b0bb; font-size:14px">${c.desc}</p>
        <p class="small" style="margin:8px 0 0">直近の開催：${c.times[0]}</p>
      </div>
      <div class="actions">
        <button class="btn ghost" data-view="${c.id}"><i class="fa-regular fa-calendar"></i> 開催時刻</button>
        <button class="btn primary" data-add="${c.id}"><i class="fa-solid fa-calendar-plus"></i> 予約に追加</button>
      </div>
    `;
    grid.appendChild(card);
  }
}

/* ========= 予約（drawer） ========= */
const drawer = document.getElementById('drawer');
function openDrawer(){ drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false'); }
function closeDrawer(){ drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true'); }
document.getElementById('openDrawer').addEventListener('click', openDrawer);
document.getElementById('closeDrawer').addEventListener('click', closeDrawer);
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeDrawer(); });

function resCount(){
  return Object.values(state.reservations).reduce((acc,it)=>acc+it.qty,0);
}
function addReservation(id){
  const c = CLASSES.find(x=>x.id===id);
  if(!c) return;
  if(!state.reservations[id]){
    state.reservations[id] = {
      id:c.id, title:c.title, img:c.img, coach:c.coach,
      time:c.times[0], times:c.times, qty:1
    };
  } else {
    state.reservations[id].qty++;
  }
  saveRes(); renderReservations(); openDrawer();
}
function changeQty(id, delta){
  if(!state.reservations[id]) return;
  state.reservations[id].qty += delta;
  if(state.reservations[id].qty<=0) delete state.reservations[id];
  saveRes(); renderReservations();
}
function changeTime(id, val){
  if(!state.reservations[id]) return;
  state.reservations[id].time = val;
  saveRes();
}
function removeRes(id){
  delete state.reservations[id]; saveRes(); renderReservations();
}
function renderReservations(){
  const box = document.getElementById('resList');
  const items = Object.values(state.reservations);
  if(items.length===0){
    box.innerHTML = `<div class="empty">まだ予約リストにクラスがありません。クラス一覧から追加してください。</div>`;
  } else {
    box.innerHTML = items.map(it=>`
      <div class="res-item">
        <img src="${it.img}" alt="${it.title}">
        <div>
          <div class="res-title">${it.title}</div>
          <div class="res-meta">担当：${it.coach}</div>
          <label class="small" for="sel_${it.id}">参加時刻</label>
          <select id="sel_${it.id}" class="select" onchange="changeTime('${it.id}', this.value)">
            ${it.times.map(t=>`<option ${t===it.time?'selected':''}>${t}</option>`).join('')}
          </select>
          <div class="qty" style="margin-top:8px">
            <button onclick="changeQty('${it.id}',-1)" aria-label="人数を1減らす">−</button>
            <span>${it.qty}</span>
            <button onclick="changeQty('${it.id}',+1)" aria-label="人数を1増やす">＋</button>
            <button class="remove" onclick="removeRes('${it.id}')" aria-label="削除">削除</button>
          </div>
        </div>
        <div style="font-weight:700">${it.qty}名</div>
      </div>
    `).join('');
  }
  document.getElementById('totalSessions').textContent = resCount();
}

/* ========= イベント ========= */
document.addEventListener('click', (e)=>{
  const add = e.target.closest('[data-add]');
  if(add){ addReservation(add.dataset.add); }

  const view = e.target.closest('[data-view]');
  if(view){
    const c = CLASSES.find(x=>x.id===view.dataset.view);
    if(c){ alert(`${c.title}\n開催候補：\n- ${c.times.join('\n- ')}`); }
  }
});

document.getElementById('checkoutBtn').addEventListener('click', ()=>{
  if(resCount()===0){ alert('予約リストが空です。'); return; }
  const summary = Object.values(state.reservations).map(it=>`${it.title}（${it.time} / ${it.qty}名）`).join('\n');
  alert('以下の内容でリクエストを送信しました（デモ）:\n\n'+summary+'\n\n※実装時はメールや予約APIに接続してください。');
});

/* 検索・フィルタ・並び替え */
document.getElementById('q').addEventListener('input', (e)=>{ state.q = e.target.value; renderClasses(); });
document.getElementById('sortSelect').addEventListener('change', (e)=>{ state.sort = e.target.value; renderClasses(); });
document.querySelectorAll('.filter-chip').forEach(ch=>{
  ch.addEventListener('click', ()=>{
    document.querySelectorAll('.filter-chip').forEach(x=>x.classList.remove('active'));
    ch.classList.add('active');
    state.filter = ch.dataset.filter;
    renderClasses();
  });
});

/* 初期描画 */
renderClasses();
renderReservations();
</script>
</body>
</html>
